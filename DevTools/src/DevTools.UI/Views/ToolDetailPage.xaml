<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="DevTools.UI.Views.ToolDetailPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DevTools.UI.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header Banner -->
        <Grid Grid.Row="0" 
              Background="{ThemeResource SystemAccentColorLight3}" 
              Padding="24,24,24,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Back button and tool info -->
            <StackPanel Grid.Column="0" Orientation="Vertical">
                <StackPanel Orientation="Horizontal" Margin="0,16,0,4">
                    <Border Background="{ThemeResource SystemAccentColorLight1}" 
                            Width="48" 
                            Height="48" 
                            CornerRadius="8">
                        <FontIcon Glyph="&#xE8F1;" 
                                  Foreground="{ThemeResource SystemAccentColor}" 
                                  FontSize="24" 
                                  HorizontalAlignment="Center" 
                                  VerticalAlignment="Center"/>
                    </Border>

                    <StackPanel Margin="16,0,0,0" VerticalAlignment="Center">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{x:Bind ViewModel.ToolMetadata.Name, Mode=OneWay}" 
                                       FontSize="24" 
                                       FontWeight="SemiBold"/>
                            <Border Margin="12,0,0,0" 
                                    Background="{ThemeResource SystemAccentColorLight1}" 
                                    BorderThickness="0" 
                                    CornerRadius="12" 
                                    Padding="8,4,8,4"
                                    VerticalAlignment="Center"
                                    Visibility="{x:Bind ViewModel.ToolMetadata.IsPremium, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                                <TextBlock Text="PREMIUM" 
                                           FontSize="10" 
                                           FontWeight="SemiBold" 
                                           Foreground="{ThemeResource SystemAccentColorDark1}"/>
                            </Border>
                        </StackPanel>
                        <TextBlock Text="{x:Bind ViewModel.ToolMetadata.Description, Mode=OneWay}" 
                                   Opacity="0.8" 
                                   MaxWidth="600"
                                   TextWrapping="Wrap"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>

            <!-- Action buttons -->
            <StackPanel Grid.Column="1" 
                        Orientation="Horizontal" 
                        VerticalAlignment="Bottom" 
                        Margin="0,0,0,4">
                <Button Command="{x:Bind ViewModel.AddToFavoriteCommand}" 
                        Visibility="{x:Bind ViewModel.IsUserLoggedIn, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                        Style="{StaticResource TextButtonStyle}" 
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                    <StackPanel Orientation="Horizontal">
                        <FontIcon Glyph="&#xE734;" FontSize="12"/>
                        <TextBlock Text="Add to favorites" Margin="8,0,0,0"/>
                    </StackPanel>
                </Button>
                <Button Margin="8,0,0,0" 
                        Style="{StaticResource AccentButtonStyle}">
                    <StackPanel Orientation="Horizontal">
                        <FontIcon Glyph="&#xE768;" FontSize="12"/>
                        <TextBlock Text="Share" Margin="8,0,0,0"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Tool Content Area -->
        <Grid Grid.Row="1" Padding="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Tabs for tool functions -->
            <TabView Grid.Row="0" Margin="0,0,0,16">
                <TabView.TabItems>
                    <TabViewItem Header="Tool Interface" IsSelected="True">
                        <TabViewItem.IconSource>
                            <SymbolIconSource Symbol="Document"/>
                        </TabViewItem.IconSource>
                    </TabViewItem>
                    <TabViewItem Header="Documentation">
                        <TabViewItem.IconSource>
                            <SymbolIconSource Symbol="Bookmarks"/>
                        </TabViewItem.IconSource>
                    </TabViewItem>
                    <TabViewItem Header="Settings">
                        <TabViewItem.IconSource>
                            <SymbolIconSource Symbol="Setting"/>
                        </TabViewItem.IconSource>
                    </TabViewItem>
                </TabView.TabItems>
            </TabView>

            <!-- Tool UI Container -->
            <Grid Grid.Row="1">
                <!-- Login Prompt -->
                <Grid Visibility="{x:Bind ViewModel.IsUserLoggedIn, Mode=OneWay, Converter={StaticResource BoolToVisibilityInverseConverter}}"
                      HorizontalAlignment="Center" 
                      VerticalAlignment="Center"
                      MaxWidth="500">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" 
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderThickness="1"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            CornerRadius="8"
                            Padding="24">
                        <StackPanel HorizontalAlignment="Center">
                            <FontIcon Glyph="&#xE72E;" 
                                      FontSize="48" 
                                      Foreground="{ThemeResource SystemAccentColor}"
                                      HorizontalAlignment="Center"/>
                            <TextBlock Text="Sign in to access this tool" 
                                       FontSize="20" 
                                       FontWeight="SemiBold" 
                                       HorizontalAlignment="Center"
                                       Margin="0,16,0,8"/>
                            <TextBlock Text="You need to be signed in to use this tool. Login now to get access to this and other powerful development tools."
                                       TextWrapping="Wrap"
                                       TextAlignment="Center"
                                       Opacity="0.8"
                                       Margin="0,0,0,24"/>
                            <Button Content="Login Now" 
                                    Style="{StaticResource AccentButtonStyle}"
                                    HorizontalAlignment="Center" 
                                    Click="Login_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- Premium indicator -->
                    <Border Grid.Row="1" 
                            Background="#FFF7E9"
                            BorderBrush="#FFDEB1"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="16"
                            Margin="0,16,0,0"
                            Visibility="{x:Bind ViewModel.ToolMetadata.IsPremium, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel Orientation="Horizontal">
                            <FontIcon Glyph="&#xEA3B;" 
                                      FontSize="16" 
                                      Foreground="#FF9D00"/>
                            <TextBlock Text="This is a premium tool. You'll need to upgrade your account after login." 
                                       Foreground="#5D4200" 
                                       Margin="12,0,0,0" 
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Actual Tool UI -->
                <Grid Visibility="{x:Bind ViewModel.IsUserLoggedIn, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                    <!-- Loading indicator -->
                    <ProgressRing x:Name="LoadingRing" 
                                  IsActive="False" 
                                  Width="40" 
                                  Height="40"/>

                    <!-- Tool content -->
                    <ContentControl Content="{x:Bind ViewModel.ToolUI, Mode=OneWay}" 
                                    HorizontalAlignment="Stretch" 
                                    VerticalAlignment="Stretch"
                                    HorizontalContentAlignment="Stretch"
                                    VerticalContentAlignment="Stretch"/>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Page>